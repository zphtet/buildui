name: Deploy to Cloud Run (staging)

on:
  push:
    branches:
      - staging

jobs:
  deploy:
    environment: staging
    permissions:
      contents: read
      id-token: write
    uses: ./.github/workflows/cicd.yml
    with:
      gcp-project-id: ${{ vars.GCP_PROJECT_ID }}
      gcp-region: ${{ vars.GCP_REGION || 'us-central1' }}
      service-name: ${{ vars.CLOUD_RUN_SERVICE_NAME_STAGING || 'build-ui-staging' }}
      artifact-registry-repo: ${{ vars.ARTIFACT_REGISTRY_REPO || 'buildui' }}
      environment: staging
    secrets:
      gcp-sa-key: ${{ secrets.GCP_SA_KEY }}

